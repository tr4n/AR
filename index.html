<!doctype html>
<html>
<head>
  <title>Happy new year!</title>

  <link rel='stylesheet' href='css/main.css'>
  <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' rel='stylesheet'
        integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC' crossorigin='anonymous'>
  <script src='https://aframe.io/releases/1.0.0/aframe.min.js'></script>
  <script
    src='https://code.jquery.com/jquery-3.6.3.js'
    integrity='sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM='
    crossorigin='anonymous'></script>
    <script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>
  <script>
    AFRAME.registerComponent("vidhandler", {
      init: function() {
        this.toggle = false;
        this.vid = document.querySelector("#vid");
        this.footer = document.querySelector("#play");
         this.vid.pause();
         this.footer.style.visibility = "hidden";
        this.vid.addEventListener("ended", (e) => {
          this.footer.style.visibility = "visible";
        }, false);
      },
      tick: function() {
        if (this.el.object3D.visible === true) {
          this.footer.style.visibility = "visible";
          if (!this.toggle) {
            this.toggle = true;
            this.vid.play();
          }
        } else if (!this.vid.ended) {
       //   this.footer.style.visibility = "hidden";
          this.toggle = false;
        //  this.vid.pause();
        }
      },
    });

    function onClick() {
      window.location.href = '/lucky.html';
    }
  </script>
</head>

<body style='margin : 0; overflow: hidden;'>

<a-scene
  embedded
  vr-mode-ui='enabled: false'
  color-space='sRGB'
  renderer="colorManagement: true; logarithmicDepthBuffer: true"
  device-orientation-permission-ui='enabled: false'
  embedded arjs='sourceType:webcam;debugUIEnabled: false;'>

  <a-assets>
    <video
      id='vid'
      preload='auto'
      loop='true'
      crossorigin webkit-playsinline playsinline controls>
      <source type='video/webm' src='assets/videos/happy_2023_2.mp4'>
      <h3>Error : Your browser does not support.</h3>
    </video>
  </a-assets>

  <a-marker
    id='animated-marker'
    vidhandler
    type='pattern' url='img/pattern-qr-code.patt'>

    <a-image
      src='assets/images/bg_square.jpg'
      scale='1.2 1.2 1.2'
      rotation='-90 0 0'
    ></a-image>

    <a-plane id='plane-video'
             scale='1.1 1.1 1.1'
             rotation='-90 0 0'
             material='transparent:true;alphaTest:0;src:#vid'
    ></a-plane>

  </a-marker>
  <a-entity camera></a-entity>
</a-scene>
<div id='play' class='fixed-bottom'>
  <div class='d-flex justify-content-center align-items-center flex-column mb-5'>
    <button type='button' class='btn btn-danger' onclick='onClick()'>VÒNG QUAY MAY MẮN</button>
  </div>
</div>
<div class="d-flex justify-content-center" style="width: 100%; height:100%">
  <div class="spinner-border text-danger" role="status">
    <span class="sr-only">Loading...</span>
  </div>
</div>
<style>
    img[alt*="000webhost"],
    img[alt*="000webhost"][style],
    img[src*="000webhost"],
    img[src*="000webhost"][style],
    body > div:nth-last-of-type(1)[style] {
        opacity: 0 !important;
        pointer-events: none !important;
        width: 0 !important;
        height: 0 !important;
        visibility: hidden !important;
        display: none !important;
    }
</style>

</body>
</html>
